---
sidebar_position: 3
---

# External Modules

To keep Deep Chat as lightweight as possible, some of its functionality requires the use of external modules.
These have been set up to be recognised inside the `window` object:

| Functionality                             | Module                                                                                                         | Window             |
| ----------------------------------------- | -------------------------------------------------------------------------------------------------------------- | ------------------ |
| Formatting [messages with code](HERE)     | [highlight.js](https://www.npmjs.com/package/highlight.js?activeTab=readme)                                    | `window.hljs`      |
| [Speech to text](HERE) with [Azure](HERE) | [microsoft-cognitiveservices-speech-sdk](https://www.npmjs.com/package/microsoft-cognitiveservices-speech-sdk) | `window.SpeechSDK` |

## Implementation

Here are some simple ways to add these modules to your project:

- <b>Dynamic import from a dependancy</b> <br />
  If you are using a dependancy manager such as npm, you can dynamically import the modules and assign them to the window
  object.
- <b>Dynamic import from a CDN</b> <br />
  If you are using a dependancy manager such as npm, you can dynamically import the modules from the following URLs and
  assign them to the window object: <br />
- <b>Script/Style from a CDN</b> <br />
  You can create script/style tags with the following URLs and append them to the document body.

  | Module                                                                                                         | URL                                                                                                                                                                    |
  | -------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | [highlight.js](https://highlightjs.org/)                                                                       | script: <br /> https://aka.ms/csspeech/jsbrowserpackageraw <br /> stylesheet: <br /> https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css |
  | [microsoft-cognitiveservices-speech-sdk](https://www.npmjs.com/package/microsoft-cognitiveservices-speech-sdk) | script (will automatically assign itself to the window object): <br /> https://aka.ms/csspeech/jsbrowserpackageraw                                                     |

- <b>Script/Style from within the project</b> <br />
  You can manually download the files from the URLs above, add them to the script/style tags, append them to the document
  body and add the modules to the window object (automatic for speech sdk).

If you are using `TypeScript`, add this to the file where the module is used:

```
declare global {
  interface Window {
    XLSX: typeof xlsx;
  }
}
```

## Examples

A React project that contains a package bundler - should work similarly across other Frameworks:

[Click for Live Example](https://codesandbox.io/s/active-table-react-xlsx-h3j7rq?file=/src/App.tsx)

VanillaJS approach with no bundler (can also use as fallback if above doesn't work):

[Click for Live Example](https://codesandbox.io/s/active-table-vanillajs-xlsx-9h3tcj?file=/index.html)

## Why

The decision for developers to download an external dependancy was not easy to make and there are a multiple reasons that
lead us down this road. <br />
The [`xlsx`](https://www.npmjs.com/package/xlsx) module's post compression file size is similar to Active Table itself, which
ruled out the idea of bundling it together as it would effectively double its size. <br />
We spent some time experimenting with dynamic imports which seemed promising, but unfortunatelly we came to
a roadblock that had no simple way of overcoming; Active Table is an injectable component that exists as part of a project
that can have a wide range of possible framework + bundler configurations and needs to do its best to run in as many of their
combinations as possible. This is where dynamic imports become problematic as they are not supported by all bundlers and in
many cases need extra configuration to make them work. <br />
Therefore, in order to help make the lives of our developers as simple as possible, we have left the decision of how to implement
[`xlsx`](https://www.npmjs.com/package/xlsx) in their hands in order to alllow them to tailor the configuration to their specific setup.

## Troubleshooting

If you are experiencing issues for importing/exporting files, please see [**github issues**](https://github.com/OvidijusParsiunas/active-table/issues) or create
a [**new issue ticket**](https://github.com/OvidijusParsiunas/active-table/issues/new/choose) and we will look into
it as soon as possible.
